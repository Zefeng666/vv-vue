webpackJsonp([8],{"/0UN":function(t,e,a){"use strict";String,String,String,String,String,Number,Array,Object,Number,Boolean;var s={name:"checker",props:{defaultItemClass:String,selectedItemClass:String,disabledItemClass:String,type:{type:String,default:"radio"},value:[String,Number,Array,Object],max:Number,radioRequired:Boolean},watch:{value:function(t){this.currentValue=t},currentValue:function(t){this.$emit("input",t),this.$emit("on-change",t)}},data:function(){return{currentValue:this.value}}},r={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vux-checker-box"},[this._t("default")],2)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(t){a("Luh7")},null,null);e.a=i.exports},"3DO2":function(t,e){},Ahvm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),r=a.n(s),i=a("1sNz"),n=a("ABCa"),u=a("odqc"),d=a("Znkm"),c=a("fBcm"),o=a("b+jt"),l=a("1DHf"),h=a("rHil"),p=a("pDNl"),v=a("7Ah8"),m=a("2sLL"),f=a("QTi7"),g=a("cHu4"),b=a("FHgB"),x=a.n(b),y=a("/0UN"),$=a("hGvq"),_=(i.a,n.a,u.a,d.a,c.a,o.a,l.a,h.a,p.a,v.a,m.a,f.a,g.a,x.a,y.a,$.a,{name:"getGoods",components:{ViewBox:i.a,XHeader:n.a,Tab:u.a,TabItem:d.a,Swiper:c.a,SwiperItem:o.a,Cell:l.a,Group:h.a,XInput:p.a,PopupPicker:v.a,XButton:m.a,Box:f.a,XAddress:g.a,ChinaAddressV4Data:x.a,Checker:y.a,CheckerItem:$.a},created:function(){this.queryOrder(),"{}"===r()(this.$route.params)?this.queryUserAddress():(this.getGoodsObj.addressId=this.$route.params.addressId,this.getGoodsObj.addressName=this.$route.params.addressName),this.queryUser()},computed:{payAmount:function(){return 2===this.checkerWhich?this.getGoodsObj.quantity>=20&&this.getGoodsObj.quantity<100?3*this.getGoodsObj.quantity*this.productInfo.dealerPrice:this.getGoodsObj.quantity>=100?3*this.getGoodsObj.quantity*this.productInfo.proxyPrice:3*this.getGoodsObj.quantity*this.productInfo.vipPrice:(this.getGoodsObj.quantity>=60&&this.$vux.toast.text("超过60件建议按箱拿货","top"),this.getGoodsObj.quantity*this.productInfo.vipPrice)}},data:function(){return{index:0,checkerWhich:2,userInfo:{},productInfo:{},getGoodsObj:{quantity:"",addressId:"",proxyProvice:"",proxyCity:"",proxyArea:"",addressName:"",addressValue:[]},orderList:[],addressData:x.a}},methods:{queryUser:function(){var t=this;this.$api.queryUser({}).then(function(e){200===e.code?(t.userInfo=e.data.user,t.queryProduct()):t.$vux.toast.text(e.message,"top")})},queryProduct:function(){var t=this;this.$api.queryProduct().then(function(e){200===e.code?t.productInfo=e.data.product:t.$vux.toast.text(e.message,"top")})},queryUserAddress:function(){var t=this;this.$api.queryUserAddress({}).then(function(e){200===e.code&&(e.data.address.length<1?t.getGoodsObj.addressName="无":(t.getGoodsObj.addressId=e.data.address[0].id,t.getGoodsObj.addressName=e.data.address[0].province+e.data.address[0].city+e.data.address[0].area+e.data.address[0].detail))})},queryOrder:function(){var t=this;this.$api.queryOrder({pageNo:1,pageSize:100}).then(function(e){200===e.code&&(t.orderList=e.data.items)})},wechatCallPay:function(){var t=this;this.$api.wechatCallPay({totalFee:100*this.payAmount}).then(function(e){200===e.code&&t.onBridgeReady(e.data.appId,e.data.nonceStr,e.data.package,e.data.paySign)})},cancelOrder:function(t){var e=this;this.$api.cancelOrder({id:t}).then(function(t){200===t.code&&(e.$vux.toast.text("取消订单成功","top"),e.queryOrder())})},insertOrder:function(){var t=this,e={};if(!this.getGoodsObj.addressId)return this.$vux.toast.text("请添加地址后再拿货~","top");e.addressId=this.getGoodsObj.addressId,e.paidFee=this.payAmount,e.productId=this.productInfo.productId,2==this.checkerWhich?e.quantity=3*this.getGoodsObj.quantity:e.quantity=this.getGoodsObj.quantity,this.$api.insertOrder(e).then(function(e){200===e.code?t.onBridgeReady(e.data.appId,e.data.nonceStr,e.data.package,e.data.paySign):t.$vux.toast.text(e.message,"top")})},toSelectAddress:function(){this.$router.push({name:"selectAddress",params:{addressId:this.getGoodsObj.addressId,addressName:this.getGoodsObj.addressName}})},toSale:function(){this.$router.push({name:"sales"})},selectChecker:function(t){},onBridgeReady:function(t,e,a,s){var i=Date.parse(new Date)/1e3;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t,timeStamp:i,nonceStr:e,package:a,signType:"MD5",paySign:s},function(t){alert(r()(t)),"get_brand_wcpay_request:ok"==t.err_msg?(this.$vux.toast.text("支付成功","top"),this.queryOrder(),this.index=1):this.$vux.toast.text("支付失败","top")})}}}),O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"getGoods"},[a("x-header",{staticClass:"vux-1px-b my-header",attrs:{"left-options":{backText:"",preventGoBack:!0},fixed:""},on:{"on-click-back":function(e){t.toSale()}}},[t._v("申请拿货")]),t._v(" "),a("tab",{staticClass:"my-tab",attrs:{"line-width":2,"active-color":"#f74c31"},model:{value:t.index,callback:function(e){t.index=e},expression:"index"}},[a("tab-item",{staticClass:"vux-center vux-1px-t",attrs:{selected:""}},[t._v("申请拿货")]),t._v(" "),a("tab-item",{staticClass:"vux-center vux-1px-t"},[t._v("历史订单")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.index,expression:"index === 0"}],staticClass:"swiper-box"},[a("group",{attrs:{"label-width":"4.5em","label-margin-right":"2em","label-align":"right"}},[a("cell",{attrs:{title:"拿货地址","align-items":"flex-start",value:t.getGoodsObj.addressName,"value-align":"left","is-link":""},nativeOn:{click:function(e){t.toSelectAddress()}}}),t._v(" "),a("x-input",{attrs:{title:"申请数量",name:"username",placeholder:"请输入","show-clear":!1},model:{value:t.getGoodsObj.quantity,callback:function(e){t.$set(t.getGoodsObj,"quantity",e)},expression:"getGoodsObj.quantity"}},[a("checker",{staticClass:"checker-box",attrs:{slot:"right","radio-required":!0,"default-item-class":"checker-item","selected-item-class":"checker-item-selected"},on:{"on-change":t.selectChecker},slot:"right",model:{value:t.checkerWhich,callback:function(e){t.checkerWhich=e},expression:"checkerWhich"}},[0===t.userInfo.historyBuyCount?a("checker-item",{attrs:{value:"1"}},[t._v("件")]):t._e(),t._v(" "),a("checker-item",{class:[2==t.checkerWhich?"checker-item-selected":""],attrs:{value:"2"}},[t._v("箱")])],1)],1),t._v(" "),a("cell",{attrs:{title:"支付金额","align-items":"flex-start","value-align":"left"}},[t._v(t._s(t.payAmount)+"元")])],1),t._v(" "),a("x-button",{staticClass:"submit-btn",attrs:{type:"primary"},nativeOn:{click:function(e){return t.insertOrder(e)}}},[t._v("提交")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.index,expression:"index === 1"}],staticClass:"tab-swiper"},t._l(t.orderList,function(e,s){return a("div",{key:s,staticClass:"order-box vux-1px-b"},[a("p",[a("span",[t._v("申请数量："+t._s(e.order.quantity)+"件")]),t._v(" "),a("span",{staticClass:"text-right"},[t._v(t._s(t._f("orderStatus")(e.order.orderStatus)))])]),t._v(" "),a("p",[a("span",[t._v("收货地址："+t._s(e.userAddress.province+e.userAddress.city+e.userAddress.area+e.userAddress.detail))])]),t._v(" "),a("p",[a("span",[t._v("创建时间："+t._s(t._f("formatDate")(e.order.createTime)))]),t._v(" "),a("x-button",{directives:[{name:"show",rawName:"v-show",value:0==e.order.isAudit,expression:"item.order.isAudit == 0"}],staticClass:"btn-right",attrs:{mini:"",plain:""},nativeOn:{click:function(a){t.cancelOrder(e.order.id)}}},[t._v("取消")])],1)])}))],1)},staticRenderFns:[]};var k=a("VU/8")(_,O,!1,function(t){a("3DO2")},"data-v-538fcbb2",null);e.default=k.exports},Bpdp:function(t,e){},Luh7:function(t,e){},QTi7:function(t,e,a){"use strict";String;var s={name:"box",props:{gap:String}},r={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{style:{margin:this.gap}},[this._t("default")],2)},staticRenderFns:[]},i=a("VU/8")(s,r,!1,null,null,null);e.a=i.exports},hGvq:function(t,e,a){"use strict";var s=a("mvHQ"),r=a.n(s),i=a("pFYg"),n=a.n(i);String,Number,Object,Boolean;var u={name:"checker-item",props:{value:{type:[String,Number,Object],required:!0},disabled:Boolean},watch:{disabled:function(t){t&&"radio"===this.$parent.type&&this.value===this.$parent.currentValue&&(this.$parent.currentValue="")}},computed:{classNames:function(){var t=this,e="string"==typeof this.value||"number"==typeof this.value,a={"vux-tap-active":!this.disabled};if(this.$parent.defaultItemClass&&(a[this.$parent.defaultItemClass]=!0),this.$parent.selectedItemClass){var s=!1;if("radio"===this.$parent.type)e&&this.$parent.currentValue===this.value?s=!0:"object"===n()(this.value)&&d(this.$parent.currentValue,this.value)&&(s=!0);else if("string"==typeof this.value)this.$parent.currentValue.indexOf(this.value)>-1&&(s=!0);else if(this.$parent.currentValue&&this.$parent.currentValue.length){s=this.$parent.currentValue.filter(function(e){return d(e,t.value)}).length>0}a[this.$parent.selectedItemClass]=s}return this.$parent.disabledItemClass&&(a[this.$parent.disabledItemClass]=this.disabled),a}},methods:{select:function(){"radio"===this.$parent.type?this.selectRadio():this.selectCheckbox()},selectRadio:function(){this.disabled||(this.$parent.currentValue===this.value?this.$parent.radioRequired||(this.$parent.currentValue=""):this.$parent.currentValue=this.value),this.$emit("on-item-click",this.value,this.disabled)},selectCheckbox:function(){this.$parent.currentValue&&null!==this.$parent.currentValue||(this.$parent.currentValue=[]);var t="string"==typeof this.value||"number"==typeof this.value;if(!this.disabled){var e=-1;(e=t?this.$parent.currentValue.indexOf(this.value):this.$parent.currentValue.map(function(t){return r()(t)}).indexOf(r()(this.value)))>-1?this.$parent.currentValue.splice(e,1):(!this.$parent.max||this.$parent.max&&null!==this.$parent.currentValue&&this.$parent.currentValue.length<this.$parent.max)&&(this.$parent.currentValue&&this.$parent.currentValue.length||(this.$parent.currentValue=[]),this.$parent.currentValue.push(this.value))}this.$emit("on-item-click",this.value,this.disabled)}}};function d(t,e){return r()(t)===r()(e)}var c={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vux-checker-item",class:this.classNames,on:{click:this.select}},[this._t("default")],2)},staticRenderFns:[]};var o=a("VU/8")(u,c,!1,function(t){a("Bpdp")},null,null);e.a=o.exports}});
//# sourceMappingURL=8.196a75930c4e2a5ea632.js.map